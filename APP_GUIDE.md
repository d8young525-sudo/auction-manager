# 📱 옥션 큐레이터 - 사용 가이드

## 🎯 앱 개요
일본 옥션(야후옥션 재팬) 아이템을 관리하고, 다른 사용자와 큐레이션을 공유하는 소셜 북마크 앱

---

## 🔐 **1. 회원가입 & 로그인**

### **회원가입**
1. 앱 실행 시 로그인 화면
2. "회원가입" 버튼 클릭
3. 입력 정보:
   - **이메일**: test@example.com
   - **비밀번호**: 6자 이상
   - **닉네임**: 옥션왕김철수
4. "회원가입" 버튼 → Firebase에 계정 생성
5. **자동으로 "일반" 등급 부여**

### **로그인**
1. 이메일 + 비밀번호 입력
2. Firebase Authentication으로 인증
3. Firestore에서 사용자 정보 로드
4. 마지막 로그인 시간 자동 업데이트

### **회원 등급 시스템**
- 🆕 **신규**: 아이템 추가, 발견 조회만 가능 (큐레이션 공개 불가)
- 👤 **일반**: 큐레이션 공개 가능 (회원가입 시 기본)
- ⭐ **열심**: 카드 황금 테두리 + "닉네임 추천템" 배지 (관리자 승급)

---

## 🏠 **2. 홈 탭 - 내 구매 목록**

### **화면 구성**
```
┌─────────────────────────────┐
│  내 구매 목록        [정렬▼] │
├─────────────────────────────┤
│ ⏰ 2개 아이템이 24시간 내 마감!│
├─────────────────────────────┤
│ [전체][즐겨찾기][구매완료][합배송]│
├─────────────────────────────┤
│ ┌─────────────────────────┐ │
│ │ [썸네일] 빈티지 나이키 자켓│ │
│ │ 마감: D-2 (⭐✓)         │ │
│ └─────────────────────────┘ │
│ ┌─────────────────────────┐ │
│ │ [썸네일] 레트로 스니커즈 │ │
│ │ 마감: 5시간 후          │ │
│ └─────────────────────────┘ │
└─────────────────────────────┘
```

### **주요 기능**

#### **필터**
- **전체**: 모든 아이템
- **즐겨찾기**: ⭐ 표시한 아이템만
- **구매완료**: ✓ 구매 완료 처리한 아이템
- **합배송**: 합배송 그룹에 포함된 아이템

#### **정렬**
- **마감일 임박순** (기본): 마감 빠른 순
- **등록일순**: 최근 등록한 순
- **가격순**: 구매가격 낮은 순

#### **아이템 카드**
```
┌──────────────────────────────┐
│ [썸네일]  빈티지 나이키 자켓    │ [⭐]
│ 80x80     마감: D-2           │ [✓]
│           사이즈: M / ¥5,000  │
│           📦 1월 합배송        │
└──────────────────────────────┘
```
- **⭐ 아이콘**: 즐겨찾기 토글 (노란색 = 즐겨찾기됨)
- **✓ 아이콘**: 구매완료 토글 (초록색 = 구매됨)
- **📦 배지**: 합배송 그룹 소속 표시
- **카드 탭**: 상세 화면으로 이동

#### **아이템 상세 화면**
```
┌────────────────────────────────┐
│  아이템 상세          [삭제 🗑]  │
├────────────────────────────────┤
│  [대형 썸네일 이미지 16:9]      │
├────────────────────────────────┤
│  빈티지 나이키 자켓              │
│                                │
│  ┌──────────────────────────┐ │
│  │ ⏰ 마감일                 │ │
│  │ 2025년 11월 15일 14:00   │ │
│  │ D-2                      │ │
│  └──────────────────────────┘ │
│                                │
│  사이즈       M                │
│  구매가격     ¥5,000           │
│  등록일       2025.11.09 09:00 │
│  상태         구매완료          │
│                                │
│  📝 메모                       │
│  상태 좋음, 빠른 배송           │
│                                │
│  [즐겨찾기] [구매완료]          │
│  [🔗 옥션 페이지 보기]         │
└────────────────────────────────┘
```

**가능한 작업:**
- **수정**: 아이템 정보 수정 불가 (삭제 후 재등록)
- **삭제**: 우상단 🗑 버튼 → 확인 → 삭제
- **즐겨찾기/구매완료 토글**: 버튼 클릭
- **옥션 페이지 보기**: 브라우저로 원본 링크 열기

---

## 🔍 **3. 발견 탭 - 큐레이션 피드**

### **화면 구성**
```
┌─────────────────────────────┐
│  발견               [정렬▼]  │
├─────────────────────────────┤
│ ┌─────────────────────────┐ │
│ │ @옥션왕김철수            │ │
│ │ [정사각형 썸네일]        │ │
│ │ 빈티지 나이키 자켓       │ │
│ │ "진짜 레어템! 추천!"    │ │
│ │ 마감: D-2               │ │
│ │ ❤️ 12  🔖 5  [내목록추가]│ │
│ └─────────────────────────┘ │
│ ┌─────────────────────────┐ │
│ │ 🌟 @큐레이터전문가 추천템 │ │ ← 열심 회원
│ │ [황금 테두리]           │ │
│ │ [정사각형 썸네일]        │ │
│ └─────────────────────────┘ │
└─────────────────────────────┘
```

### **주요 기능**

#### **정렬**
- **최신순**: 최근 공개된 아이템
- **인기순**: 좋아요 + 북마크 많은 순

#### **필터링 (자동)**
- ✅ 공개 설정된 아이템만 표시
- ✅ **마감 지난 아이템 자동 제외**
- ✅ 최대 50개까지 로드 (성능 최적화)

#### **카드 기능**
- **❤️ 좋아요**: 탭하면 빨간색으로 변경 + 카운트 증가
- **🔖 북마크**: 탭하면 파란색으로 변경 + 나중에 보기
- **내 목록에 추가**: 원클릭으로 내 홈에 복사 (비공개로)

#### **열심 회원 특별 표시**
```
┌───────────────────────────────┐
│ @큐레이터전문가  [⭐ 큐레이터전문가 추천템] │
│ [황금색 테두리 2px]            │
│ [정사각형 썸네일]              │
│ 제목...                       │
└───────────────────────────────┘
```
- 황금색 테두리 (amber.shade700)
- "⭐ 닉네임 추천템" 배지
- 닉네임 황금색 강조

---

## ➕ **4. 추가 탭 - 아이템 등록**

### **STEP 1: 링크 입력**
```
┌────────────────────────────────┐
│  옥션 링크를 붙여넣으세요       │
│  [https://page.auctions....   ]│
│           [붙여넣기] [불러오기] │
└────────────────────────────────┘
```
1. 야후옥션 재팬 상품 페이지 URL 복사
2. 입력창에 붙여넣기
3. **"불러오기"** 버튼 클릭

### **STEP 2: 자동 로딩 (2-3초)**
```
⏳ 상품 정보를 불러오는 중...
```
- Open Graph 메타 태그에서 추출:
  - **제목**: `og:title`
  - **썸네일**: `og:image`
- 실패 시 수동 입력 가능

### **STEP 3: 마감일 설정**
```
⚠️ 마감일은 옥션 페이지에서 확인해주세요
[🔗 옥션 페이지 다시 보기]

빠른 선택:
[+1일] [+3일] [+7일]

또는 직접 입력:
날짜: [2025-11-15 📅]
시간: [14:00 🕐]
```
- **빠른 선택**: 오늘 기준 +N일, 14:00 자동 설정
- **직접 입력**: 날짜/시간 피커로 정확한 마감 시각

### **STEP 4: 추가 정보 (선택)**
```
사이즈: [M              ]
메모:   [여러 줄 텍스트  ]

☐ 구매완료
  구매가격: [¥5,000]
  합배송 그룹: [1월 합배송 ▼]
    - 그룹 없음
    - 2025년 1월 합배송
    - [+ 새 그룹 만들기]
```

### **STEP 5: 공개 설정**
```
공개 설정:
○ 비공개 (나만 보기)
● 공개 (피드에 공유)

[공개 시]
추천 코멘트: [진짜 레어템! 추천!]
해시태그: [#빈티지] [#패션] [+ 추가]

[저장]
```

**저장 시 자동 처리:**
- Firestore에 아이템 저장
- 마감 24시간 전 알림 예약
- 즐겨찾기면 72시간 전 알림도 예약

---

## 👤 **5. 프로필 탭**

### **화면 구성**
```
┌────────────────────────────────┐
│  프로필              [설정 ⚙️]  │
├────────────────────────────────┤
│       [프로필 사진]             │
│       옥션왕김철수              │
│       일본 옥션 전문가          │
├────────────────────────────────┤
│  [전체 아이템]  [공개 아이템]  │
│      15개          8개         │
│                                │
│  [합배송 그룹]                  │
│      3개                       │
├────────────────────────────────┤
│ 📦 합배송 그룹 관리 >           │
│ 🚪 로그아웃                    │
└────────────────────────────────┘
```

### **합배송 그룹 관리**
```
┌────────────────────────────────┐
│  합배송 그룹                    │
├────────────────────────────────┤
│ 📦 2025년 1월 합배송            │
│    3개 아이템 / ¥15,000         │
│    [관리]                [삭제] │
│                                │
│ 📦 피규어 합배송                │
│    5개 아이템 / ¥28,000         │
│    [관리]                [삭제] │
│                                │
│ [+ 새 그룹 만들기]              │
└────────────────────────────────┘
```

---

## 🔔 **6. 알림 시스템**

### **로컬 알림 (자동)**
- **마감 24시간 전**: 모든 아이템
- **마감 72시간 전**: 즐겨찾기 아이템만

### **알림 내용**
```
⏰ 빈티지 나이키 자켓 마감이 24시간 남았어요!
마감: 2025.11.15 14:00
```

### **알림 권한**
- Android 13+에서 자동 요청
- 설정 화면에서 재요청 가능

---

## 📊 **7. 데이터 흐름**

### **아이템 추가 시**
```
사용자 입력
    ↓
[메타데이터 추출]
    ↓
[Firestore 저장]
    ├─ items/{itemId}
    └─ userId = 현재 사용자
    ↓
[알림 예약]
    ├─ 24시간 전
    └─ 72시간 전 (즐겨찾기)
    ↓
완료!
```

### **발견 탭 로드 시**
```
Firestore 쿼리
    ↓
WHERE isPublic = true
AND deadline >= 현재시각
ORDER BY deadline ASC
LIMIT 50
    ↓
실시간 스트림
(자동 업데이트)
```

### **좋아요/북마크 시**
```
사용자 클릭
    ↓
[Firestore 트랜잭션]
    ├─ likes/{userId}_{itemId}
    └─ items/{itemId}.likeCount += 1
    ↓
실시간 UI 업데이트
```

---

## 🔒 **8. Firebase 보안 규칙**

### **Firestore 규칙**
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 사용자
    match /users/{userId} {
      allow read: if true;  // 모두 읽기 가능
      allow write: if request.auth.uid == userId;  // 본인만 수정
    }
    
    // 아이템
    match /items/{itemId} {
      allow read: if true;  // 모두 읽기 가능
      allow create: if request.auth != null;  // 로그인 사용자만 생성
      allow update, delete: if request.auth.uid == resource.data.userId;  // 본인만 수정/삭제
    }
    
    // 좋아요/북마크
    match /likes/{likeId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /bookmarks/{bookmarkId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}
```

### **과도한 읽기 방지**
- ✅ 쿼리 limit 설정 (50개)
- ✅ 인덱스 생성 (deadline + createdAt)
- ✅ 캐싱 활성화
- ✅ 페이지네이션 준비

---

## 🎯 **9. 회원 등급 관리 (관리자)**

### **Firebase Console에서 등급 변경**
1. Firebase Console 접속
2. **Firestore Database** → **users** 컬렉션
3. 특정 사용자 문서 선택
4. `tier` 필드 수정:
   - `newbie`: 신규 (큐레이션 공개 불가)
   - `regular`: 일반
   - `premium`: 열심 (카드 강조)
5. 저장

### **앱에서 확인**
- 해당 사용자가 공개한 아이템
- → 발견 탭에서 황금 테두리 + 배지 표시

---

## 🐛 **10. 문제 해결**

### **Q: 마감 지난 아이템이 발견에 보여요**
**A**: Firestore 쿼리에 마감일 필터 적용됨 (최신 버전)

### **Q: 내 아이템을 수정하고 싶어요**
**A**: 현재 수정 기능 없음 → 삭제 후 재등록

### **Q: 다른 사람 아이템을 수정/삭제하고 싶어요**
**A**: 불가능 (Firebase 보안 규칙으로 차단)

### **Q: 알림이 안 와요**
**A**: Android 설정 → 알림 권한 확인

### **Q: 회원 등급을 변경하고 싶어요**
**A**: Firebase Console에서 관리자가 직접 변경

---

## 📱 **11. Android APK 빌드 방법**

```bash
# 1. 프로젝트로 이동
cd /home/user/auction_manager

# 2. APK 빌드
flutter build apk --release

# 3. 결과물 위치
# build/app/outputs/flutter-apk/app-release.apk
```

**설치 방법:**
1. APK 파일을 Android 기기로 전송
2. "알 수 없는 앱 설치" 권한 허용
3. APK 파일 실행 → 설치

---

## 🎯 **12. 주요 사용 시나리오**

### **시나리오 1: 첫 사용자**
1. 회원가입 (자동 "일반" 등급)
2. 야후옥션에서 상품 링크 복사
3. 추가 탭 → 링크 붙여넣기 → 마감일 설정
4. 비공개로 저장 → 홈에서 확인

### **시나리오 2: 큐레이터**
1. 아이템 추가 시 "공개" 선택
2. 추천 코멘트 작성
3. 발견 탭에서 본인 아이템 확인
4. 다른 사용자들의 좋아요/북마크 받기

### **시나리오 3: 열심 회원**
1. 관리자가 `tier: premium`으로 변경
2. 본인 공개 아이템에 황금 테두리 표시
3. "⭐ 닉네임 추천템" 배지 노출

---

## 💡 **13. 팁 & 트릭**

- **마감 임박 아이템**: 홈 상단 배너에 자동 표시
- **즐겨찾기 활용**: 중요한 아이템만 따로 관리
- **합배송 그룹**: 구매완료 후 그룹으로 묶어 관리
- **빠른 입력**: 마감일 빠른 선택 버튼 활용
- **알림**: 24시간/72시간 전 자동 알림

---

이게 전체 앱의 사용 방법입니다! 
APK 빌드가 필요하시면 말씀해주세요! 🚀
